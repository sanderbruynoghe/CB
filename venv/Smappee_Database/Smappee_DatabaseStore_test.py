# Smappee_DatabaseStore_test.py
import json
import sqlite3
import Smappee_DatabaseStore
from Smappee_DatabaseQuery import *

# Remark: First create the database&tables with Smappee_DatabaseCreate

'''1s data'''
def test1s():
    data1s_str = '''{"totalPower":2916,"totalReactivePower":1777,"totalExportEnergy":0,"totalImportEnergy":424356906,"monitorStatus":0,"utcTimeStamp":1565624476000,"channelPowers":[{"publishIndex":0,"formula":"$5500001259/3$","power":1072,"exportEnergy":0,"importEnergy":215272825,"phaseId":0,"current":52},{"publishIndex":1,"formula":"$5500001259/2$","power":925,"exportEnergy":0,"importEnergy":144097190,"phaseId":1,"current":26},{"publishIndex":2,"formula":"$5500001259/1$","power":918,"exportEnergy":0,"importEnergy":64980836,"phaseId":2,"current":84},{"publishIndex":3,"formula":"$5500001259/0$","power":1000,"exportEnergy":0,"importEnergy":41880836,"phaseId":0,"current":48},{"publishIndex":4,"formula":"$5500001258/3$","power":844,"exportEnergy":18,"importEnergy":11907732,"phaseId":1,"current":42},{"publishIndex":5,"formula":"$5500001258/2$","power":867,"exportEnergy":0,"importEnergy":12434100,"phaseId":2,"current":42},{"publishIndex":6,"formula":"$5500001258/1$","power":0,"exportEnergy":310,"importEnergy":0,"phaseId":0,"current":0},{"publishIndex":7,"formula":"$5500001258/0$","power":0,"exportEnergy":95148,"importEnergy":7128467,"phaseId":1,"current":0},{"publishIndex":8,"formula":"$5500001260/3$","power":0,"exportEnergy":257,"importEnergy":37757,"phaseId":2,"current":0},{"publishIndex":12,"formula":"$5500000554/3$","power":0,"exportEnergy":0,"importEnergy":11229738,"phaseId":1,"current":0},{"publishIndex":9,"formula":"$5500000554/2$","power":4,"exportEnergy":0,"importEnergy":25124025,"phaseId":0,"current":0},{"publishIndex":13,"formula":"$5500000554/1$","power":3,"exportEnergy":0,"importEnergy":21649663,"phaseId":0,"current":0},{"publishIndex":14,"formula":"$5500000554/0$","power":0,"exportEnergy":0,"importEnergy":13429888,"phaseId":0,"current":1},{"publishIndex":15,"formula":"$5500000555/3$","power":0,"exportEnergy":0,"importEnergy":28591175,"phaseId":0,"current":0},{"publishIndex":16,"formula":"$5500000555/2$","power":52,"exportEnergy":0,"importEnergy":95760638,"phaseId":1,"current":3},{"publishIndex":10,"formula":"$5500000555/1$","power":563,"exportEnergy":19054,"importEnergy":126165137,"phaseId":1,"current":25},{"publishIndex":11,"formula":"$5500000555/0$","power":2791,"exportEnergy":268763,"importEnergy":396759763,"phaseId":2,"current":121}],"voltages":[{"voltage":225,"phaseId":0},{"voltage":229,"phaseId":1},{"voltage":231,"phaseId":2}]}'''
    data1s = json.loads(data1s_str)
    print(json.dumps(data1s, indent=4, sort_keys=True))
    Smappee_DatabaseStore.store_to_database_1s(data1s)
#test1s()

'''5m data'''
def test5m():
    data5m_str = '''{"intervalDatas":[{"publishIndex":0,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":113962,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2319,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":4023,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":186649,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":941,"serviceLocationId":41598}]},{"publishIndex":1,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":165767,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2307,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":4028,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":97463,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":2492,"serviceLocationId":41598}]},{"publishIndex":2,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEC","channel":0,"mRID":"1.1003.32.63"},"value":398976,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEC","channel":0,"mRID":"1.158.32.29"},"value":2346,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASECA","channel":0,"mRID":"1.158.40.29"},"value":4030,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEC","channel":0,"mRID":"1.37.32.38"},"value":59284,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEC","channel":0,"mRID":"1.4.32.5"},"value":7859,"serviceLocationId":41598}]},{"publishIndex":3,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":31879,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2319,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":4023,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":38230,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":214,"serviceLocationId":41598}]},{"publishIndex":4,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":29163,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2307,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":4028,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":31,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":125,"serviceLocationId":41598}]},{"publishIndex":5,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEC","channel":0,"mRID":"1.1003.32.63"},"value":32813,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEC","channel":0,"mRID":"1.158.32.29"},"value":2346,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASECA","channel":0,"mRID":"1.158.40.29"},"value":4030,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEC","channel":0,"mRID":"1.37.32.38"},"value":523,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEC","channel":0,"mRID":"1.4.32.5"},"value":139,"serviceLocationId":41598}]},{"publishIndex":6,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":48,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2319,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":4023,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":44,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":0,"serviceLocationId":41598}]},{"publishIndex":7,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":3797,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2307,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":4028,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":97,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":16,"serviceLocationId":41598}]},{"publishIndex":8,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEC","channel":0,"mRID":"1.1003.32.63"},"value":4284,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEC","channel":0,"mRID":"1.158.32.29"},"value":2346,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASECA","channel":0,"mRID":"1.158.40.29"},"value":4030,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEC","channel":0,"mRID":"1.37.32.38"},"value":7,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEC","channel":0,"mRID":"1.4.32.5"},"value":18,"serviceLocationId":41598}]},{"publishIndex":12,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":1658,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2319,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":4023,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":173,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":7,"serviceLocationId":41598}]},{"publishIndex":9,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":3980,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2319,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":4023,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":4510,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":25,"serviceLocationId":41598}]},{"publishIndex":13,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":19664,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2307,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":4028,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":4326,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":86,"serviceLocationId":41598}]},{"publishIndex":14,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":21994,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2319,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":4023,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":253,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":94,"serviceLocationId":41598}]},{"publishIndex":15,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":4251,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2319,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":4023,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":143,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":18,"serviceLocationId":41598}]},{"publishIndex":16,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":23649,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2307,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":4028,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":55025,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":258,"serviceLocationId":41598}]},{"publishIndex":10,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEC","channel":0,"mRID":"1.1003.32.63"},"value":67119,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEC","channel":0,"mRID":"1.158.32.29"},"value":2346,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASECA","channel":0,"mRID":"1.158.40.29"},"value":4030,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEC","channel":0,"mRID":"1.37.32.38"},"value":664538,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEC","channel":0,"mRID":"1.4.32.5"},"value":2892,"serviceLocationId":41598}]},{"publishIndex":11,"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":181839,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2307,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":4028,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":1891825,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":8094,"serviceLocationId":41598}]},{"readingFromStream":false,"version":1,"utcEndtime":1565094300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ALWAYS_ON","unit":"WATT","phase":"NOTAPPLICABLE","channel":0,"mRID":"1.1008.0.38"},"value":87995,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"LOADTOTAL_ACTIVE_POWER","unit":"WATT","phase":"NOTAPPLICABLE","channel":0,"mRID":"1.1009.0.38"},"value":343398,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"PRODUCTIONTOTAL_ACTIVE_POWER","unit":"WATT","phase":"NOTAPPLICABLE","channel":0,"mRID":"1.1010.0.38"},"value":2556363,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"IMPORTTOTAL_ACTIVE_POWER","unit":"WATT","phase":"NOTAPPLICABLE","channel":0,"mRID":"1.1011.0.38"},"value":0,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"EXPORTTOTAL_ACTIVE_POWER","unit":"WATT","phase":"NOTAPPLICABLE","channel":0,"mRID":"1.1012.0.38"},"value":2212965,"serviceLocationId":41598}]}]}'''
    data5m = json.loads(data5m_str)
    print(json.dumps(data5m, indent=4, sort_keys=True))
    Smappee_DatabaseStore.store_to_database_5m(data5m)
#test5m()

'''Query database to check if new data added'''
def testQuery():
    conn = sqlite3.connect('Smappee_data.db')
    c = conn.cursor()
    print(database_query("SELECT * from data5m"))         # Change table name
#testQuery()
