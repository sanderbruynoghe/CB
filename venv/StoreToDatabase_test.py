import json
from Smappee_DatabaseStore import store_to_database
import sqlite3

# Example input message from Smappee
str_msg = '''b'{"intervalDatas":[{"publishIndex":0,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":244591,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2278,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":3980,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":2173627,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":9695,"serviceLocationId":41598}]},{"publishIndex":1,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":190249,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2301,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":3987,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":70449,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":1296,"serviceLocationId":41598}]},{"publishIndex":2,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEC","channel":0,"mRID":"1.1003.32.63"},"value":381320,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEC","channel":0,"mRID":"1.158.32.29"},"value":2310,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASECA","channel":0,"mRID":"1.158.40.29"},"value":3968,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEC","channel":0,"mRID":"1.37.32.38"},"value":44345,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEC","channel":0,"mRID":"1.4.32.5"},"value":4186,"serviceLocationId":41598}]},{"publishIndex":3,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":80491,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2278,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":3980,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":87745,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":521,"serviceLocationId":41598}]},{"publishIndex":4,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":29449,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2301,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":3987,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":38,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":127,"serviceLocationId":41598}]},{"publishIndex":5,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEC","channel":0,"mRID":"1.1003.32.63"},"value":31539,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEC","channel":0,"mRID":"1.158.32.29"},"value":2310,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASECA","channel":0,"mRID":"1.158.40.29"},"value":3968,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEC","channel":0,"mRID":"1.37.32.38"},"value":262,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEC","channel":0,"mRID":"1.4.32.5"},"value":135,"serviceLocationId":41598}]},{"publishIndex":6,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":73,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2278,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":3980,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":-2,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":0,"serviceLocationId":41598}]},{"publishIndex":7,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":3530,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2301,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":3987,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":179,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":14,"serviceLocationId":41598}]},{"publishIndex":8,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEC","channel":0,"mRID":"1.1003.32.63"},"value":4083,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEC","channel":0,"mRID":"1.158.32.29"},"value":2310,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASECA","channel":0,"mRID":"1.158.40.29"},"value":3968,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEC","channel":0,"mRID":"1.37.32.38"},"value":97,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEC","channel":0,"mRID":"1.4.32.5"},"value":17,"serviceLocationId":41598}]},{"publishIndex":12,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":1630,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2278,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":3980,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":122,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":6,"serviceLocationId":41598}]},{"publishIndex":9,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":121202,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2278,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":3980,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":94042,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":672,"serviceLocationId":41598}]},{"publishIndex":13,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":8886,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2301,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":3987,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":3437,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":41,"serviceLocationId":41598}]},{"publishIndex":14,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":109985,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2278,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":3980,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":811034,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":3707,"serviceLocationId":41598}]},{"publishIndex":15,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEA","channel":0,"mRID":"1.1003.128.63"},"value":4128,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEA","channel":0,"mRID":"1.158.128.29"},"value":2278,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEAB","channel":0,"mRID":"1.158.132.29"},"value":3980,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEA","channel":0,"mRID":"1.37.128.38"},"value":57,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEA","channel":0,"mRID":"1.4.128.5"},"value":17,"serviceLocationId":41598}]},{"publishIndex":16,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":24483,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2301,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":3987,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":56032,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":264,"serviceLocationId":41598}]},{"publishIndex":10,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEC","channel":0,"mRID":"1.1003.32.63"},"value":81209,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEC","channel":0,"mRID":"1.158.32.29"},"value":2310,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASECA","channel":0,"mRID":"1.158.40.29"},"value":3968,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEC","channel":0,"mRID":"1.37.32.38"},"value":346983,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEC","channel":0,"mRID":"1.4.32.5"},"value":1549,"serviceLocationId":41598}]},{"publishIndex":11,"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"REACTIVE_POWER","unit":"VOLTAMPEREREACTIVE","phase":"PHASEB","channel":0,"mRID":"1.1003.64.63"},"value":179565,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEB","channel":0,"mRID":"1.158.64.29"},"value":2301,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"VOLTAGE","unit":"VOLT","phase":"PHASEBC","channel":0,"mRID":"1.158.66.29"},"value":3987,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ACTIVE_POWER","unit":"WATT","phase":"PHASEB","channel":0,"mRID":"1.37.64.38"},"value":989702,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"CURRENT","unit":"AMPERE","phase":"PHASEB","channel":0,"mRID":"1.4.64.5"},"value":4354,"serviceLocationId":41598}]},{"readingFromStream":false,"version":1,"utcEndtime":1565253300000,"measurements":[{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"ALWAYS_ON","unit":"WATT","phase":"NOTAPPLICABLE","channel":0,"mRID":"1.1008.0.38"},"value":79680,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"LOADTOTAL_ACTIVE_POWER","unit":"WATT","phase":"NOTAPPLICABLE","channel":0,"mRID":"1.1009.0.38"},"value":2288422,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"PRODUCTIONTOTAL_ACTIVE_POWER","unit":"WATT","phase":"NOTAPPLICABLE","channel":0,"mRID":"1.1010.0.38"},"value":1336687,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"IMPORTTOTAL_ACTIVE_POWER","unit":"WATT","phase":"NOTAPPLICABLE","channel":0,"mRID":"1.1011.0.38"},"value":1109898,"serviceLocationId":41598},{"readingFromStream":false,"version":0,"type":{"commodity":"ELECTRICITY","measurementKind":"EXPORTTOTAL_ACTIVE_POWER","unit":"WATT","phase":"NOTAPPLICABLE","channel":0,"mRID":"1.1012.0.38"},"value":158162,"serviceLocationId":41598}]}]}'''
print(type(str_msg))

# Convert to json dict
json_msg = json.loads(str_msg[2:])
print(type(json_msg))

# Store to database
store_to_database(json_msg)

#Check if added to database
conn = sqlite3.connect('example.db')
c = conn.cursor()
print(c.execute('SELECT utc from data').fetchall())
print(c.execute('SELECT utc from weather').fetchall())
conn.close()
    # You can see that an entry is added if there is one extra item in the weather table
    # Conslusion: store_to_database: WORKING